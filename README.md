# Unix Project
###### π  μ λ‹‰μ¤ μ‹μ¤ν… μμ—…μ‹κ°„μ— λ°°μ΄ λ‚΄μ©μ„ λ°”νƒ•μΌλ΅ μ‚¬λ¬Όν•¨ κ΄€λ¦¬ μ‹μ¤ν…μ„ κµ¬ν„. 
###### μ„λ²„ - ν΄λΌμ΄μ–ΈνΈ(server - client) λ¨λΈλ΅ λ™μ‘ν•λ” μ‚¬λ¬Όν•¨ κ΄€λ¦¬ μ‹μ¤ν….

β–¶ 0. μ»΄νμΌ
> gcc -o server server.c
> gcc -o client client.c


β–¶ 1. ν”„λ΅μ νΈ λ‚΄μ© μ†κ°

β–¶ 1-1. λ‚΄μ© μ†κ°

μ λ‹‰μ¤ μ‹μ¤ν… μμ—…μ‹κ°„μ— λ°°μ΄ λ‚΄μ©μ„ λ°”νƒ•μΌλ΅ μ‚¬λ¬Όν•¨ κ΄€λ¦¬ μ‹μ¤ν…μ„ κµ¬ν„.
μ„λ²„ - ν΄λΌμ΄μ–ΈνΈ(server - client) λ¨λΈλ΅ λ™μ‘ν•λ” μ‚¬λ¬Όν•¨ κ΄€λ¦¬ μ‹μ¤ν….

β–¶ 1-2. κ°λ… μ„¤λ…
μ„λ²„ : μ‚¬λ¬Όν•¨μ„ κ΄€λ¦¬ν•λ” μ—­ν• μ„ μν–‰. μ‚¬λ¬Όν•¨ κ΄€λ¦¬, ν΄λΌμ΄μ–ΈνΈλ“¤μ—κ² μ‚¬λ¬Όν•¨ μ κ³µ λ° λΉ„λ°€λ²νΈ μ„¤μ •μ„ ν•  μ μλ„λ΅ ν•¨.
ν΄λΌμ΄μ–ΈνΈ : μ‚¬λ¬Όν•¨ κ΄€λ¦¬ μ‹μ¤ν…μ κ³ κ° μ—­ν• μ„ μν–‰. μ‚¬λ¬Όν•¨ μ‚¬μ© λ° λΉ„λ°€λ²νΈ μ„¤μ •μ„ μν–‰.

β–¶ 1-3. κΈ°λ³Έ κΈ°λ¥

- μ„λ²„

  β—† μ‚¬μ©μμ—κ² μ‚¬λ¬Όν•¨μ— λ€ν• μ •λ³΄λ¥Ό μ κ³µ
  β—† μ‚¬μ©μμ—κ² μ‚¬λ¬Όν•¨ ν• λ‹Ή μ‹ ν¨μ¤μ›λ“λ¥Ό μ§€μ •ν•λ„λ΅ ν•¨
  β—† μ‚¬μ©μκ°€ λ³ΈμΈ μ‚¬λ¬Όν•¨μ— μ ‘κ·Ό μ‹ μ…λ ¥ν•λ” ν¨μ¤μ›λ“κ°€ λ§λ”μ§€ ν™•μΈν•κ³ , 
     λ§μΌλ©΄ μ ‘κ·Ό κ°€λ¥ν•λ„λ΅ ν•¨

- ν΄λΌμ΄μ–ΈνΈ

  β—† μ›ν•λ” μ‚¬λ¬Όν•¨μ— μ ‘κ·Ό
  β—† ν•΄λ‹Ή μ‚¬λ¬Όν•¨μ λΉ„λ°€λ²νΈ μ„¤μ • λ° μ…λ ¥ κΈ°λ¥

β†’ μ„ κΈ°λ³Έ κΈ°λ¥μ— μ¶”κ°€ κΈ°λ¥μ„ μ‚½μ…ν•μ—¬ ν”„λ΅κ·Έλ¨μ μ™„μ„±λ„λ¥Ό λ†’μ„.

β–¶ 2. μ „μ²΄ μ½”λ“μ νλ¦„

μ„λ²„ = server ν΄λΌμ΄μ–ΈνΈ = client λΌκ³  μ§€μΉ­.

(0) μ„λ²„ ν΄λΌμ΄μ–ΈνΈ μ‹¤ν–‰ κ³Όμ •

1. μ„λ²„κ°€ μ‹¤ν–‰ λλ©΄μ„ λ½μ»¤ κµ¬μ΅°μ²΄, μ„λ²„ μ†μΌ“ μƒμ„±λλ‹¤.
2. μ„λ²„μ—μ„ μ‚¬λ¬Όν•¨ κ°μλ¥Ό λ™μ ν• λ‹Ήμ„ μ΄μ©ν•μ—¬ λ°›κ³  κ°μλ§νΌ μ΄κΈ° μ„Έν…ν•΄μ„ ν™”λ©΄μ— μ¶λ ¥
3. ν΄λΌμ΄μ–ΈνΈκ°€ μ‹¤ν–‰ λλ©΄μ„ ν΄λΌμ΄μ–ΈνΈ μ†μΌ“ μƒμ„±λκ³  μ„λ²„μ— μ—°κ²°μ”μ²­μ„ ν•¨.
4. μ„λ²„κ°€ μ—°κ²°μ”μ²­μ„ μλ½ν•¨.

(1) server : fdμ— μ‚¬λ¬Όν•¨κ°μ s write
(1) client : μ„λ²„μ—μ„ fdμ— κΈ°λ΅ν• μ‚¬λ¬Όν•¨κ°μλ¥Ό indexμ— read

(2) server : ν„μ¬ μ‚¬λ¬Όν•¨ μƒνƒ ν΄λΌμ΄μ–ΈνΈμ— μ „λ‹¬ν•λ”λ° 
μ‚¬λ¬Όν•¨ λΉ„μ–΄μμ„ κ²½μ° : emptynum='1'μ„ clientfdμ— κΈ°λ΅
μ‚¬λ¬Όν•¨μ΄ λΉ„μ–΄μμ§€ μ•λ” κ²½μ° : emptynum='0'μ„ clientfdμ— κΈ°λ΅
(2) client : μ‚¬λ¬Όν•¨ μ •λ³΄ μ¶λ ¥
μ„λ²„μ—μ„ clientfdμ— κΈ°λ΅ν• κ°’μ΄ '1' μ΄λ©΄ ifλ¬Έ μν–‰, '0' μ΄λ©΄ else-ifλ¬Έ μν–‰ ν•μ—¬ μ‚¬λ¬Όν•¨ μ •λ³΄ μ¶λ ¥

(3-1) server : ν΄λΌμ΄μ–ΈνΈλ΅λ¶€ν„° μ½μ€ λ¬Έμκ°€ cμ΄λ©΄ μ±„ν…λ¨λ“ μ‹μ‘
(3-1) client : μ±„ν…λ¨λ“μ„μ„ μ„λ²„μ— μ „λ‹¬ν•¨

(3-2) server : ν΄λΌμ΄μ–ΈνΈλ΅λ¶€ν„° μ½μ€ λ¬Έμκ°€ nμ΄λ©΄ μ‚¬λ¬Όν•¨ μ‚¬μ©λ¨λ“λ΅ μ§„μ…
(3-2) client : μ‚¬λ¬Όν•¨ λ²νΈλ¥Ό μ…λ ¥μ‹ -> μ‚¬λ¬Όν•¨ μ‚¬μ©λ¨λ“λ΅ μ§„μ… (clientfdμ— 'n'μ— write())

(4) server : clientfdμ— κΈ°λ΅λ μ‚¬λ¬Όν•¨ λ²νΈλ¥Ό useidμ— μ €μ¥
(4) client : μ…λ ¥ν• μ‚¬λ¬Όν•¨ λ²νΈλ¥Ό clientfdμ— write

μ—¬κΈ°μ„ λ‘κ°€μ§€λ΅ κ°λ¦Ό

// μ‚¬λ¬Όν•¨μ΄ λΉ„μ–΄μλ” κ²½μ°

(5) server : clientfdμ— 'Y'λ¥Ό write
(5) client : μ‚¬λ¬Όν•¨μ μ‚¬μ©κ°€λ¥μ—¬λ¶€λ¥Ό μ½μ–΄λ“¤μΈλ‹¤.

(6) server : clientfdμ— writeν• passwordλ¥Ό Rpasswordμ— read()
(6) client : λΉ„λ°€λ²νΈλ¥Ό clientμ— write()

// μ‚¬λ¬Όν•¨μ΄ λΉ„μ–΄μμ§€ μ•λ” κ²½μ°

(5) server : clientfdμ— 'N'λ¥Ό write

(7) server : ν΄λΌμ΄μ–ΈνΈμ—μ„ μ…λ ¥ν• λΉ„λ°€λ²νΈλ¥Ό Inputpwdμ— write
(7) client : μ…λ ¥ν• λΉ„λ°€λ²νΈλ¥Ό Inputpwdμ— write

(8) server : μ‚¬λ¬Όν•¨μ •λ³΄μ— κΈ°λ΅λ λΉ„λ°€λ²νΈλ¥Ό sendpasswordμ— write
(8) client : μ‚¬λ¬Όν•¨μ •λ³΄μ— κΈ°λ΅λ λΉ„λ°€λ²νΈλ¥Ό Outputpwdμ— read()
λ§μ•½ inputpwd == outputpwd : ν¨μ¤ inputpwd != outputpwd : μ΄κΈ°ν™”λ©΄μΌλ΅ λμ•„κ°


(9) server : ν΄λΌμ΄μ–ΈνΈ μΆ…λ£ μ—¬λ¶€λ¥Ό QuestionFromClientμ— read() -> ν΄λΌμ΄μ–ΈνΈ μΆ…λ£μ‹ μ™€μΌλ¬Έ λΉ μ Έλ‚μ΄
(9) client : ν΄λΌμ΄μ–ΈνΈ μΆ…λ£ μ—¬λ¶€λ¥Ό serverμ— μ•λ¦¬κΈ° μ„ν•΄ clientfdμ— N write -> N μ…λ ¥μ‹ ν΄λΌμ΄μ–ΈνΈ μΆ…λ£

(10) server : ν΄λΌμ΄μ–ΈνΈμ—μ„ μ—…λ°μ΄νΈλ μ‚¬λ¬Όν•¨ μ •λ³΄λ¥Ό νμ΄ν”„μ— κΈ°λ΅ ν›„ μ—…λ°μ΄νΈλ μ‚¬λ¬Όν•¨ μƒνƒλ¥Ό μ„λ²„μ— μ €μ¥ ν›„ μ¶λ ¥

(11) server : ν΄λΌμ΄μ–ΈνΈ μΆ…λ£μ‹ λ‹¤μ μ‹¤ν–‰ν•  ν΄λΌμ΄μ–ΈνΈ μ§„ν–‰ (while λ¬Έ)






β–¶ 3. μ¶”κ°€κΈ°λ¥
  β—† 1000μ›μ„ λ„£μ–΄μ•Ό μ‚¬λ¬Όν•¨μ΄ μ—΄λ¦¬λ” μ‹μ¤ν…
  β—† λ™μ ν• λ‹ΉμΌλ΅ μ‚¬λ¬Όν•¨ ν¬κΈ°λ¥Ό μ§€μ •
  β—† μ„λ²„/ν΄λΌμ΄μ–ΈνΈ μ±„ν… κΈ°λ¥
  β—† λΉ„λ°€λ²νΈ μ„¤μ • μ‹ λ‘ λ² μ…λ ¥ν•μ—¬ μ λ€λ΅ λΉ„λ°€λ²νΈλ¥Ό μ„¤μ •ν•  μ μλ„λ΅ ν•¨


β–¶ 4. μ°μμ„±
  β—† λ™μ ν• λ‹ΉμΌλ΅ μ‚¬λ¬Όν•¨ ν¬κΈ°λ¥Ό μ§€μ •ν•  μ μμ–΄ μ‚¬μ©μκ°€ μ›ν•λ” λ§νΌμ μ‚¬λ¬Όν•¨ κ°μλ¥Ό λ§λ“¤ μ μλ‹¤.

    // μ„λ²„ μµμ΄μ‹¤ν–‰μ‹ μ‚¬λ¬Όν•¨ μ„Έν…
    printf("μ‚¬λ¬Όν•¨ κ°μλ¥Ό μ…λ ¥ν•μ„Έμ” : ");
    // μ‚¬λ¬Όν•¨ κ°μ μ…λ ¥ ( λ¬Έμμ—΄ )
    scanf("%s",s);

    // κµ¬μ΅°μ²΄ ν¬μΈν„° λ™μ ν• λ‹Ή ( μ‚¬λ¬Όν•¨ κ°μ λ§νΌ )
    rec2 = (struct rocker *) malloc((k+1)*sizeof(struct rocker));
        
    printf("\n* * * * * * * * * * * * *  Locker * * * * * * * * * * * * * \n");
    printf("*γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅*\n");
    // 1λ² μ‚¬λ¬Όν•¨λ¶€ν„° kλ² μ‚¬λ¬Όν•¨κΉμ§€ μ‚¬λ¬Όν•¨ μ΄κΈ°μƒνƒ setting
    for(int i=1;i<=k;i++)
    {
    rec2[i].id = i;
    rec2[i].empty = 1;
    strcpy(rec2[i].pwd,"0000");
    printf("|      Rocker Num : %d        |       Empty :     Yes       |\n",i);
    printf("*γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅ * γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅γ…΅*\n");
    }
  β—† μ„λ²„/ν΄λΌμ΄μ–ΈνΈ κ°„μ μ±„ν… κΈ°λ¥μ„ μ΄μ©ν•μ—¬ ν΄λΌμ΄μ–ΈνΈ μ‚¬μ©μκ°€ μ„λ²„ κ΄€λ¦¬μμ—κ² κ¶κΈν• μ μ„ μ§λ¬Έν•  μ μλ‹¤.

    // μ…λ ¥ν• λ²νΈκ°€ 66096301 -> μ±„ν… μ‹μ‘ 
            if(!strcmp(useid,"66096301"))
            {   
                // (3)-1. μ±„ν…λ¨λ“μ„μ„ μ„λ²„μ— μ „λ‹¬ 
                m='c';
                write(clientfd,&m,1);
                printf("\nκ΄€λ¦¬μμ™€μ μ±„ν…μ„ μ‹μ‘ν•©λ‹λ‹¤. μΆ…λ£ν•μ‹λ ¤λ©΄ Qλ¥Ό μ…λ ¥ν•μ„Έμ” \n");
                while(1)
                {
                    printf("Me : ");
                    scanf(" %[^\n]s",Smessage); 
                    write(clientfd,&Smessage,sizeof(Smessage));
                    if(!strcmp(Smessage,"Q")) break;
                    else
                    {   
                    read(clientfd, &Rmessage, sizeof(Rmessage));
                    printf("Manager : %s\n",Rmessage);
                    }
                }
            continue;   
            }

    // (3)-1. ν΄λΌμ΄μ–ΈνΈλ΅λ¶€ν„° μ½μ€ λ¬Έμκ°€ cλ©΄ μ±„ν…λ¨λ“ μ‹μ‘
                read(clientfd,&r,1);
                if(r=='c')
                {
                    printf("\n\n* κ³ κ°μΌλ΅λ¶€ν„° μ±„ν…μ΄ μ™”μµλ‹λ‹¤. μ±„ν…μ„ μ‹μ‘ν•©λ‹λ‹¤.\n");      
                    while(1)
                    {
                        read(clientfd,&Rmessage,sizeof(Rmessage));
                        printf("Client : %s\n",Rmessage);
                        if(!strcmp(Rmessage,"Q")) break;
                        else
                        {
                        printf("Me : ");
                        scanf(" %[^\n]s",Smessage);
                        write(clientfd,&Smessage,sizeof(Smessage));
                        }
                    }
                    continue;
                }

  β—† λΉ„λ°€λ²νΈλ¥Ό μ„¤μ • μ‹ λ‘ λ² μ…λ ¥ν•μ—¬ νΉμ—¬λ‚ μƒκ°ν• λΉ„λ°€λ²νΈλ¥Ό μλ» μ…λ ¥ν•μ—¬ λ‚μ¤‘μ— λΉ„λ°€λ²νΈλ¥Ό μ°Ύκ±°λ‚ λ³€κ²½ν•λ” λ¬Έμ λ¥Ό λ―Έμ—°μ— λ°©μ§€ν•  μ μλ‹¤.

    // λΉ„λ°€λ²νΈ μ…λ ¥ 
                    printf("%sλ² μ‚¬λ¬Όν•¨μ λΉ„λ°€λ²νΈλ¥Ό μ„¤μ •ν•΄μ£Όμ„Έμ” : ",useid);
                    scanf("%s",password);
                    
                    // + μ¶”κ°€κΈ°λ¥ : λΉ„λ°€λ²νΈν™•μΈμ„μ„ν•΄ μ¬μ…λ ¥ 
                    while(1)
                    {
                    printf("μ„¤μ •ν•μ‹¤ λΉ„λ°€λ²νΈλ¥Ό λ‹¤μ‹ μ…λ ¥ν•΄μ£Όμ„Έμ” : ");
                    scanf("%s",password2);
                    if(!strcmp(password,password2)) break;
                    }


